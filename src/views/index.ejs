<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title id="index">P Financial App</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="all,follow">
    <!-- Bootstrap CSS-->
    <link rel="stylesheet" href="jp/vendor/bootstrap/css/bootstrap.min.css">
    <link href="css/select.bootstrap.min.css" rel="stylesheet">
    <link href="vendor/datatables/dataTables.bootstrap4.min.css" rel="stylesheet">
    <!-- Font Awesome CSS-->
    <link rel="stylesheet" href="jp/vendor/font-awesome/css/font-awesome.min.css">
    <!-- Fontastic Custom icon font-->
    <link rel="stylesheet" href="jp/css/fontastic.css">
    <!-- Google fonts - Roboto -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700">
    <!-- jQuery Circle-->
    <link rel="stylesheet" href="jp/css/grasp_mobile_progress_circle-1.0.0.min.css">
    <!-- Custom Scrollbar-->
    <link rel="stylesheet" href="jp/vendor/malihu-custom-scrollbar-plugin/jquery.mCustomScrollbar.css">
    <!-- theme stylesheet-->
    <link rel="stylesheet" href="jp/css/style.default.css" id="theme-stylesheet">
    <!-- Custom stylesheet - for your changes-->
    <link rel="stylesheet" href="jp/css/custom.css">
    <!-- Favicon-->
    <link rel="shortcut icon" href="jp/img/favicon.ico">
    <!-- Charge form CSS -->
    <link href="css/Payment.css" rel="stylesheet">
    <link href="css/common.css" rel="stylesheet">
    <!--<link href="css/colors.css" rel="stylesheet">-->
    <!-- Tweaks for older IEs--><!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]-->
  </head>
  <body>
    <!-- Include to display modals -->
    <%- include('partials/modals') %>
    <%- include('partials/sidebarnav') %>
    <%- include('partials/functions') %>

    <div class="page">

      <%- include('partials/headers') %>

      <!-- Statistics Section-->
      <br>
      <section class="statistics">
        <div class="container-fluid">
          <div class="row d-flex">
            <div class="col-lg-4">
              <!-- Income-->
              <div class="card income text-center">
                <strong class="text-primary">Current Budget for <%=currentMonth%></strong>
                <br>
                <div class="chart">
                    <canvas id="monthlyBudgetChart" width="350" height="350"></canvas>
                </div>
                <br>
                <div class="b-dashboard-col70">
                    <div class="b-dashboard-accounts-balance">Available<span><span><%= currencyFormatted(budgetRemaining) %></span></span>
                        <div class="b-dashboard-accounts-balance-circle" style="background: rgb(102, 179, 96);"></div>
                    </div>
                </div>
                <div class="b-dashboard-col70">
                    <div class="b-dashboard-accounts-balance">Spent<span><%= currencyFormatted(totalMonthlyCharges) %></span>
                      <div class="b-dashboard-accounts-balance-circle" style="background: rgb(146, 182, 199);"></div>
                    </div>
                </div>
                <div class="b-dashboard-col70">
                    <div class="b-dashboard-accounts-balance">
                      On Budget Number<span><%= currencyFormatted(currentOnBudget) %></span>
                    </div>
                </div>
              </div>
            </div>
            <div class="col-lg-4">
              <!-- Total Monthly Spending-->
              <div class="card income text-center">
                <strong class="text-primary">Total Monthly Spending</strong>
                <br>
                <!-- Circle Chart for monthly budget -->
                <div class="chart">
                  <canvas id="totalMonthlyChart" width="350" height="350"></canvas>
                </div>
                <br>
                <div class="b-dashboard-accounts-info">
                  <div class="b-dashboard-col70">
                      <div class="b-dashboard-accounts-balance">Total Monthly Spend<span><span><%= currencyFormatted(allMonthlyCharges) %></span></span>
                      <div class="b-dashboard-accounts-balance-circle" style="<%=totalMonthlyFillColor%>"></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-lg-4">
              <!-- Monthly Usage-->
              <div class="card income text-center">
                <strong class="text-primary">Top 5 Vendors</strong>
                <br>
                <div class="chart">
                  <canvas id="topVendorChart" width="300px" height="450px"></canvas>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      <br>
      <!-- Updates Section -->
      <section class="dashboard-header section-padding">
        <div class="container-fluid">
          <div class="row d-flex align-items-md-stretch">
            <div class="col-lg-12">
              <div class="card to-do">
                <strong class="text-primary ml-3">Charges for the Month of <%=currentMonth%></strong>
                <div class="card-body">
                  <div class="table-responsive">
                    <table class="table table-striped table-bordered nowrap" id="recentChargesTable" width="100%" cellspacing="0">
                      <thead>
                        <tr>
                          <th>ID</th>
                          <th>Date</th>
                          <th>Vendor</th>
                          <th>Amount</th>
                          <th>Payment Type</th>
                          <th>Category</th>
                          <th>Comments</th>
                        </tr>
                      </thead>
                      <tbody>
                        <%if (monthlyCharges.length==0) {%>
                        <tr>
                          <td>None</td>
                          <td>None</td>
                          <td>None</td>
                          <td>None</td>
                          <td>None</td>
                          <td>None</td>
                          <td>None</td>
                        <%} else {%>
                        <%for(let i=0; i<monthlyCharges.length; i++) {%>
                        <tr>
                          <td><%=monthlyCharges[i]._id%></td>
                          <td><%=("0" + (monthlyCharges[i].chargeDate.getMonth()+1)).slice(-2) + '/' + ("0" + monthlyCharges[i].chargeDate.getDate()).slice(-2) + '/'+ monthlyCharges[i].chargeDate.getFullYear();%></td>
                          <td><%=monthlyCharges[i].vendor%></td>
                          <td><%= currencyFormatted(monthlyCharges[i].amount) %></td>
                          <td><%=monthlyCharges[i].paymentType%></td>
                          <td><%=monthlyCharges[i].category%></td>
                          <td><%=monthlyCharges[i].comments%></td>
                        </tr>
                        <%}}%>
                      </tbody>
                    </table>
                  </div>
                </div>
                <!--<div class="card-footer small text-muted">Last Updated <%if (monthlyCharges.length==0) {%> N/A <%} else {("0" + (monthlyCharges[0].chargeDate.getMonth()+1)).slice(-2) + '/' + ("0" + monthlyCharges[0].chargeDate.getDate()).slice(-2) + '/'+ monthlyCharges[0].chargeDate.getFullYear();}%></div>-->
              </div>
            </div>
          </div>
        </div>
      </section>
      <footer class="main-footer">
        <div class="container-fluid">
          <div class="row">
            <div class="col-sm-6">
              <p>Jon Pawlowski &copy; 2019</p>
            </div>
          </div>
        </div>
      </footer>
    </div>
    <!-- JavaScript files-->
    <!-- Datatables JS Files -->
    <script src="vendor/jquery/jquery.js"></script>
    <script src="vendor/datatables/jquery.dataTables.js"></script>
    <script src="vendor/datatables/dataTables.bootstrap4.js"></script>
    <script src="vendor/datatables/dataTables.responsive.min.js"></script>
    <script src="vendor/datatables/dataTables.buttons.min.js"></script>
    <script src="vendor/bootstrap/js/responsive.bootstrap.min.js"></script>
    <script src="vendor/datatables/dataTables.select.min.js"></script>
    <!-- Page level plugin JavaScript-->
    <script src="vendor/chart.js/Chart.js"></script>
    <!--<script src="jp/vendor/jquery/jquery.min.js"></script>-->

    <script src="jp/vendor/popper.js/umd/popper.min.js"> </script>
    <script src="jp/vendor/bootstrap/js/bootstrap.min.js"></script>
    <script src="jp/js/grasp_mobile_progress_circle-1.0.0.min.js"></script>
    <script src="jp/vendor/jquery.cookie/jquery.cookie.js"> </script>
    <!--<script src="jp/vendor/chart.js/Chart.min.js"></script>-->
    <script src="jp/vendor/jquery-validation/jquery.validate.min.js"></script>
    <script src="jp/vendor/malihu-custom-scrollbar-plugin/jquery.mCustomScrollbar.concat.min.js"></script>
    <!--<script src="jp/js/charts-home.js"></script>-->
    <script src="js/moment.min.js"></script>
    <script src="js/datetime-moment.js"></script>
    <!-- Datatables scripts for this page-->
    <script src="js/demo/datatables-demo.js"></script>
    <!-- Main File-->
    <script src="jp/js/front.js"></script>
    <!-- script to create total monthly doughnut chart. located in ejs partial monthlyCharts.ejs -->
    <%- include('partials/monthlyCharts') %>
  </body>
</html>
